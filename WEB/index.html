<!doctype html>
<html lang="us">
<head>
	<meta charset="utf-8">
	<title>Web klijent</title>
	<link href="jquery-ui.css" rel="stylesheet">
	<link href="jquery-clockpicker.min.css" rel="stylesheet">
</head>
<style>
	body {
	font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
	font-size: 14px;
}
.container {
    padding: 20px;
}
</style>
<body>

<button type="button" id="ucitaj">Učitaj</button>

<div id="datepicker"></div>



<div class="container">
    <input id="input-a" value="" data-default="20:48">
    <button type="button" id="button-a">Odaberi minute</button>
    <button type="button" id="button-b">Odaberi sate</button>
</div>


<script src="external/jquery/jquery.js"></script>
<script src="jquery-ui.js"></script>
<script src="jquery-clockpicker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstimezonedetect/1.0.6/jstz.min.js"></script>
<script>



$.datepicker.setDefaults({
	closeText: "Zatvori",
	prevText: "&#x3C;",
	nextText: "&#x3E;",
	currentText: "Danas",
	monthNames: [ "Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj",
	"Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac" ],
	monthNamesShort: [ "Sij","Velj","Ožu","Tra","Svi","Lip",
	"Srp","Kol","Ruj","Lis","Stu","Pro" ],
	dayNames: [ "Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota" ],
	dayNamesShort: [ "Ned","Pon","Uto","Sri","Čet","Pet","Sub" ],
	dayNamesMin: [ "Ne","Po","Ut","Sr","Če","Pe","Su" ],
	weekHeader: "Tje",
	dateFormat: "dd.mm.yy.",
	firstDay: 1,
	isRTL: false,
	showMonthAfterYear: false,
	yearSuffix: "" });

$( "#datepicker" ).datepicker({
	inline: true
});




var input = $('#input-a');
input.clockpicker({
    autoclose: true,
    afterDone: function() {
                            posaljiNaServer();
                        }
});

// Manual operations
$('#button-a').click(function(e){
    // Have to stop propagation here
    e.stopPropagation();
    input.clockpicker('show')
            .clockpicker('toggleView', 'minutes');
});
$('#button-b').click(function(e){
    // Have to stop propagation here
    e.stopPropagation();
    input.clockpicker('show')
            .clockpicker('toggleView', 'hours');
});


function posaljiNaServer(){
	
	var currentTimezone = jstz.determine();
	 var timezone = currentTimezone.name();
	 console.log(timezone);
	
	var d = new Date($("#datepicker").datepicker( "getDate" ));

	var s = dateAdd(d, 'hour', $("#input-a").val().split(":")[0]);
	var m = dateAdd(s, 'minute', $("#input-a").val().split(":")[1]);
	//moment.tz(m, timezone);
	console.log(m);
	
	
		
}


function dateAdd(date, interval, units) {
  var ret = new Date(date); //don't change original date
  var checkRollover = function() { if(ret.getDate() != date.getDate()) ret.setDate(0);};
  switch(interval.toLowerCase()) {
    case 'year'   :  ret.setFullYear(ret.getFullYear() + units); checkRollover();  break;
    case 'quarter':  ret.setMonth(ret.getMonth() + 3*units); checkRollover();  break;
    case 'month'  :  ret.setMonth(ret.getMonth() + units); checkRollover();  break;
    case 'week'   :  ret.setDate(ret.getDate() + 7*units);  break;
    case 'day'    :  ret.setDate(ret.getDate() + units);  break;
    case 'hour'   :  ret.setTime(ret.getTime() + units*3600000);  break;
    case 'minute' :  ret.setTime(ret.getTime() + units*60000);  break;
    case 'second' :  ret.setTime(ret.getTime() + units*1000);  break;
    default       :  ret = undefined;  break;
  }
  return ret;
}


</script>
</body>
</html>
